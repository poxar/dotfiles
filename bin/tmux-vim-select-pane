#!/bin/sh
# Like `tmux select-pane`, but if Vim is running in the current pane it sends
# a `<M-h/j/k/l>` keystroke to Vim instead.
set -eu

cmd="$(tmux display -p '#{pane_current_command}')"
cmd="$(basename "$cmd" | tr A-Z a-z)"

if test "$cmd" = "nvim" || test "$cmd" = "vim" || test "$cmd" = "vi"; then
  case "$1" in
    "-l") direction='\;' ;;
    "-L") direction='h' ;;
    "-D") direction='j' ;;
    "-U") direction='k' ;;
    "-R") direction='l' ;;
    *) exit 1;;
  esac
  tmux send-keys "M-$direction"
else
  tmux select-pane "$@"
fi

#!/bin/sh
set -e

rp_ror() {
  id="$(ratpoison -c "windows %n %c" | grep -i "$1" | head -n1 | awk '{ print $1 }')"
  if test -n "$id"; then
    ratpoison -c "select $id"
  else
    $2
  fi
}

if test -z "$1"; then
  echo "Usage: $0 winclass [executable]"
  exit 1
fi

if test -z "$2"; then
  executable="$1"
else
  executable="$2"
fi

wm="$(xprop -root -notype -len 100 -f _NET_WM_NAME 8t | grep '^_NET_WM_NAME' | cut -d\" -f 2)"

case "$wm" in
  "ratpoison") rp_ror "$1" "$executable" ;;
  *)
    echo "Unknown window manager: $wm"
    exit 1
    ;;
esac
